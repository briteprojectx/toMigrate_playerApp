<ion-header >
    <ion-navbar class="mg2u-navbar" hideBackButton >
        <ion-title >{{headerTitle}}</ion-title >
        <ion-buttons start (click)="close()" >
            <button  ion-button icon-only>
                <ion-icon name="close-circle"></ion-icon>
            </button >
        </ion-buttons >
        <ion-buttons end>
            <button *ngIf="mode === 'approval'" ion-button icon-only (click)="getListApplications()">
                <i class="fa fa-fw fa-sync"></i>
            </button>
        </ion-buttons>
    </ion-navbar >
</ion-header >

<ion-content class="has-header" >
    <ion-segment *ngIf="mode === 'edit'" [(ngModel)] = "optionTypes" color = "warning" no-padding style="padding-top:1em; padding-bottom:1em">
        <ion-segment-button (click) = "setOptionType(1)" value = "details">
            DETAILS
        </ion-segment-button>
        <ion-segment-button (click) = "setOptionType(2)" value = "clubApprovals">
            CLUB APPROVALS
        </ion-segment-button>
    </ion-segment>

    <div *ngIf="0">
    <ion-list *ngIf="optionTypes === 'types'">
        <ion-item>
            <button ion-button clear item-right >
                <!-- (click)="addPlayerTypes()" -->
                <i class="fa fa-plus" aria-hidden="true"></i>&nbsp;Add Player Type
            </button>
        </ion-item>
        <ion-card>
            <ion-row>
                <ion-col><strong>Senior</strong>
                <ul class="no-bullets">
                    <li>Current Age : 60</li>
                </ul></ion-col>
                <ion-col col-3 style="align-self: center;text-align: right;">
                    <button ion-button outline><i class="far fa-fw fa-edit"></i></button>
                    <button ion-button outline color="danger"><i class="far fa-fw fa-trash-alt"></i></button>
                </ion-col>
            </ion-row>
        </ion-card>
        <ion-card>
            <ion-row>
                <ion-col><strong>Government</strong>
                <ul class="no-bullets">
                    <li><i class="fas fa-fw fa-hashtag"></i>ID : x123asf</li>
                    <li><i class="fas fa-fw fa-paperclip"></i>Has document attached</li>
        </ul>
    </ion-col>
    <ion-col col-3 style="align-self: center;text-align: right;">
        <button ion-button outline><i class="far fa-fw fa-edit"></i></button>
        <button ion-button outline color="danger"><i class="far fa-fw fa-trash-alt"></i></button>
    </ion-col>
            </ion-row>
        </ion-card>
    </ion-list>

    <ion-list *ngIf="optionTypes === 'discount'">
        <ion-row no-padding>
        <ion-col col-12 no-padding>
            <button ion-button clear full>Discount Card(s)</button>
        </ion-col>
        <ion-item>
            <button ion-button clear item-right >
                <!-- (click)="addPlayerTypes()" -->
                <i class="fa fa-plus" aria-hidden="true"></i>&nbsp;Add Discount Card
            </button>
        </ion-item>
    </ion-row>
        <ion-card>
            <ion-row>
                <ion-col no-padding padding-left><b>AGSSG - Premier Senior Golfer - <i>With Insurance</i> </b>
                    <ul class="no-bullets">
                        <li><i class="fas fa-fw fa-hashtag"></i>ID : AGSSG123</li>
                        <li><i class="fas fa-fw fa-paperclip"></i>Has document attached</li>
            </ul>
        </ion-col>
                <ion-col no-padding padding-right col-4 text-right>Expires dd-mm-yyyy</ion-col>
            </ion-row>
            <ion-row>
                <ion-col padding-left padding-right no-padding text-left col-9>
                    <ul>
                        <li>Valid only for Club A</li>
                        <li>Valid only for Club B</li>
                        <li>Valid from dd-mm-yyyy till dd-mm-yyyy</li>
                    </ul>       
                </ion-col>
                <ion-col style="align-self: center;text-align: right;">
                    <button ion-button outline><i class="far fa-fw fa-edit"></i></button>
                    <button ion-button outline color="danger"><i class="far fa-fw fa-trash-alt"></i></button>
                </ion-col>
            </ion-row>
        </ion-card>
        <ion-card>
            <ion-row>
                <ion-col no-padding padding-left><b>AGSSG - Premier Golfer 1 - <i>With Insurance</i> </b>
                    <ul class="no-bullets">
                        <li><i class="fas fa-fw fa-hashtag"></i>ID : AGSSG456</li>
                        <li><i class="fas fa-fw fa-paperclip"></i>Has document attached</li>
            </ul>
        </ion-col>
                <ion-col no-padding padding-right col-4 text-right>Expires dd-mm-yyyy</ion-col>
            </ion-row>
            <ion-row>
                <ion-col padding-left padding-right no-padding text-left col-9>
                    <ul>
                        <li>Valid only for Club A</li>
                        <li>Valid only for Club B</li>
                        <li>Valid from dd-mm-yyyy till dd-mm-yyyy</li>
                    </ul>       
                </ion-col>
                <ion-col style="align-self: center;text-align: right;">
                    <button ion-button outline><i class="far fa-fw fa-edit"></i></button>
                    <button ion-button outline color="danger"><i class="far fa-fw fa-trash-alt"></i></button>
                </ion-col>
            </ion-row>
        </ion-card>

        <ion-card>
            <ion-row>
                <ion-col no-padding padding-left><b>Reward Card A </b>
                    <ul class="no-bullets">
                        <li><i class="fas fa-fw fa-hashtag"></i>ID : RewA123</li>
                        <li><i class="fas fa-fw fa-paperclip"></i>Has document attached</li>
            </ul>
        </ion-col>
                <ion-col no-padding padding-right col-4 text-right>Expires dd-mm-yyyy</ion-col>
            </ion-row>
            <ion-row>
                <ion-col padding-left padding-right no-padding text-left col-9>
                    <ul>
                        <li>Valid only for Club A</li>
                        <li>Valid only for Club B</li>
                        <li>Valid from dd-mm-yyyy till dd-mm-yyyy</li>
                    </ul>       
                </ion-col>
                <ion-col style="align-self: center;text-align: right;">
                    <button ion-button outline><i class="far fa-fw fa-edit"></i></button>
                    <button ion-button outline color="danger"><i class="far fa-fw fa-trash-alt"></i></button>
                </ion-col>
            </ion-row>
        </ion-card>

    </ion-list>

    <ion-list *ngIf="optionTypes === 'voucher'">
        <ion-row col-12>
            <ion-col col-9 style="padding-left:1em">
        <!-- <ion-label color="primary">Code</ion-label> -->
        <ion-input placeholder="Enter voucher code"></ion-input>
            </ion-col>
            <ion-col col-3 style="text-align: right; align-self: center;">
        <button ion-button>Search</button>
            </ion-col>
        </ion-row>
        <ion-card>
            <ion-row>
                <ion-col><b>Voucher N</b></ion-col>
                <ion-col text-right>Expires dd-mm-yyyy</ion-col>
            </ion-row>
            <ion-row>
                <ion-col padding-left padding-right no-padding text-left col-9>
                    <ul>
                        <li>Applicable only for xxx</li>
                        <li>Valid from dd-mm-yyyy till dd-mm-yyyy</li>
                    </ul>
                </ion-col>
                <ion-col style="align-self: center;text-align: right;">
                    <button *ngIf="type==='player'" ion-button outline>Claim</button>
                    <button *ngIf="type==='club'" ion-button outline>Apply</button>
                </ion-col>
            </ion-row>
        </ion-card>
        <ion-card>
            <ion-row>
                <ion-col><b>Voucher N</b></ion-col>
                <ion-col text-right>Expires dd-mm-yyyy</ion-col>
            </ion-row>
            <ion-row>
                <ion-col padding-left padding-right no-padding text-left col-9>
                    <ul>
                        <li>Applicable only for xxx</li>
                        <li>Valid from dd-mm-yyyy till dd-mm-yyyy</li>
                    </ul>
                </ion-col>
                <ion-col style="align-self: center;text-align: right;">
                    <button *ngIf="type==='player'" ion-button outline>Claim</button>
                    <button *ngIf="type==='club'" ion-button outline>Apply</button>
                </ion-col>
            </ion-row>
        </ion-card>
        <ion-card>
            <ion-row>
                <ion-col><b>Voucher N</b></ion-col>
                <ion-col text-right>Expires dd-mm-yyyy</ion-col>
            </ion-row>
            <ion-row>
                <ion-col padding-left padding-right no-padding text-left col-9>
                    <ul>
                        <li>Applicable only for xxx</li>
                        <li>Valid from dd-mm-yyyy till dd-mm-yyyy</li>
                    </ul>
                </ion-col>
                <ion-col style="align-self: center;text-align: right;">
                    <button *ngIf="type==='player'" ion-button outline>Claim</button>
                    <button *ngIf="type==='club'" ion-button outline>Apply</button>
                </ion-col>
            </ion-row>
        </ion-card>

    </ion-list>
</div>
<ion-list *ngIf="type==='playerType'">
    <ion-item>
        <ion-label>Select Player Type</ion-label>
        <ion-select style="max-width:100%" [(ngModel)]="selectedPlayerType">
            <!-- <ng-container *ngFor="let pType of playerTypes">
                <ion-option *ngIf="pType.use" [value]="pType.id">{{pType.name}}</ion-option>
            </ng-container> -->
            <ng-container *ngFor="let pType of playerTypes">
                <ion-option [value]="pType">{{pType.name}}</ion-option>
            </ng-container>
          <!-- <ion-option value="cash">Club - Cash</ion-option>
          <ion-option value="offcc">Club - Credit/Debit Card</ion-option>
          <ion-option value="offnb">Club - Offline Fund Transfer</ion-option>
          <ion-option value="online">Club - Online Fund Transfer</ion-option>
          <ion-option value="mg2ucredit">MyGolf2u Credit</ion-option> -->
        </ion-select>
      </ion-item>
      <ion-item *ngIf="selectedPlayerType">Description : {{selectedPlayerType.description}}</ion-item>
      <ion-item  *ngIf="isCordova()" (click)="onUploadCardClick()">
        <button ion-button full>
          <span>Upload document</span>
        </button>
      </ion-item>
      <ion-item  *ngIf="!isCordova()">
          <button ion-button full>
            <i>Upload document (coming soon on web)</i>
          </button>
        </ion-item>
          <ion-thumbnail >
              <!-- style="width:calc(100% - 8rem);text-align: -webkit-center" -->
              <img *ngIf="temporaryImageURL" (click)="onZoomImage(temporaryImageURL)" 
          class="document-image" [src]="temporaryImageURL" />
        </ion-thumbnail>
</ion-list>
<ion-list *ngIf="type==='playerDiscount' && mode === 'new'">
    <ion-item (click)="onSearchDiscountCompany()">
        <ion-label><span>{{getDiscountCompanyName()}}</span><i *ngIf="(!this.selectedDiscountCompany) || this.selectedDiscountCompany && !this.selectedDiscountCompany.name" class="fas fa-fw fa-caret-down"></i></ion-label>
    </ion-item>
      <ion-item *ngIf="discountPrograms && discountPrograms.length > 0">
        <ion-label><span>Select Discount Program</span></ion-label>
        <ion-select style="max-width:100%" [(ngModel)]="selectedDiscountProgram">
            <ng-container *ngFor="let program of discountPrograms">
                <ion-option [value]="program.id">{{program.name}}</ion-option>
            </ng-container>
        </ion-select>
      </ion-item>
      <ion-item>
          <ion-label style="padding-right: 2em;">
              Membership #
          </ion-label>
          <ion-input text-right style="text-align:right;" [(ngModel)]="cardMembershipNo" placeholder="Enter membership # here" type="text"></ion-input>
      </ion-item>
      <ion-item>
          <ion-label>Valid from</ion-label>
          <ion-datetime displayFormat="DDD, DD MMM 'YY" 
          pickerFormat="DD-MMM-YYYY" [(ngModel)]="cardValidFrom" (ionChange)="onValidFromChange()" [max]="cardMaxDate"></ion-datetime>
          <!-- [min]="minDate" -->
      </ion-item>
      <ion-item>
          <ion-label>Valid until</ion-label>
          <ion-datetime displayFormat="DDD, DD MMM 'YY" 
          pickerFormat="DD-MMM-YYYY" [(ngModel)]="cardValidUntil" [max]="cardMaxDate"></ion-datetime>
          <!-- (ionChange)="asdsd()" --> 
      </ion-item>
      <ion-item  *ngIf="isCordova()" (click)="onUploadCardClick()">
        <button ion-button full>
          <span>Upload document</span>
        </button>
      </ion-item>
      <ion-item  *ngIf="!isCordova()">
          <button ion-button full>
            <i>Upload document (coming soon on web)</i>
          </button>
        </ion-item>
          <ion-thumbnail >
              <!-- style="width:calc(100% - 8rem);text-align: -webkit-center" -->
              <img *ngIf="temporaryImageURL" (click)="onZoomImage(temporaryImageURL)" 
          class="document-image" [src]="temporaryImageURL" />
        </ion-thumbnail>
      <!-- <ion-item [disabled]="true"><i>Upload document (coming soon)</i></ion-item> -->
</ion-list>
<ion-list *ngIf="type==='playerDiscount' && mode === 'edit' && optionTypes === 'details'">
    <ion-item style="padding-right: 1em;">
        <ion-label item-start>Company</ion-label>
        <ion-label item-end text-right>{{playerDiscountProgram.discountProgram.discountCompany.name}}</ion-label>
    </ion-item>
    
    <ion-item style="padding-right: 1em;">
        <ion-label item-start>Discount Program</ion-label>
        <ion-label item-end text-right>{{playerDiscountProgram.discountProgram.name}}</ion-label>
      </ion-item>
      
      <!-- <ion-item style="padding-right: 1em;">
        <ion-label item-start style="padding-right: 2em;">Membership #
        </ion-label>
        <ion-label item-end text-right>{{playerDiscountProgram.membershipNumber}}</ion-label>
    </ion-item> -->
    <ion-item>
        <ion-label style="padding-right: 2em;">
            Membership #
        </ion-label>
        <ion-input text-right style="text-align:right;" [(ngModel)]="cardMembershipNo" placeholder="Enter membership # here" type="text"></ion-input>
    </ion-item>
    <ng-container *ngIf="checkCardApproved()">
    <p text-wrap style="color: red;padding-left:1rem;padding-right:1rem;">
        <span>* To change validity dates, please remove this card from any Club Approval and re-apply for Club Approval once dates have changed</span>
    </p>
    <!-- <ion-item style="color:red" text-wrap color="danger">
        * To change validity dates, please remove this card from any Club Approval and re-apply for Club Approval once dates have changed
    </ion-item> -->
    <ion-item style="padding-right: 1em;">
        <ion-label item-start>Valid from</ion-label>
        <ion-label item-end text-right>{{playerDiscountProgram.validFrom}}</ion-label>
    </ion-item>
    <ion-item style="padding-right: 1em;">
        <ion-label>Valid until</ion-label>
        <ion-label item-end text-right>{{playerDiscountProgram.validUntil}}</ion-label>
    </ion-item>
</ng-container>
    <ng-container *ngIf="!checkCardApproved()">
        <ion-item>
            <ion-label>Valid from</ion-label>
            <ion-datetime displayFormat="DDD, DD MMM 'YY" 
            pickerFormat="DD-MMM-YYYY" [(ngModel)]="cardValidFrom" (ionChange)="onValidFromChange()" [max]="cardMaxDate"></ion-datetime>
        </ion-item>
        <ion-item>
            <ion-label>Valid until</ion-label>
            <ion-datetime displayFormat="DDD, DD MMM 'YY" 
            pickerFormat="DD-MMM-YYYY" [(ngModel)]="cardValidUntil" [max]="cardMaxDate"></ion-datetime>
        </ion-item>
    </ng-container>


      <!-- <ion-item [disabled]="true"><i>Upload document (coming soon)</i></ion-item> -->
      <ion-item style="padding-right: 1em;" *ngIf="isCordova()" (click)="onUploadCardClick()">
          <button ion-button full>
            <span *ngIf="playerDiscountProgram.document">Change Document</span>
            <span *ngIf="!playerDiscountProgram.document">Upload document</span>
          </button>
        </ion-item>
        <ion-item  *ngIf="!isCordova()">
            <button ion-button full>
              <i>Upload document (coming soon on web)</i>
            </button>
          </ion-item>
            <ion-thumbnail *ngIf="playerDiscountProgram.document" >
                <!-- style="width:calc(100% - 8rem);text-align: -webkit-center" -->
                <img (click)="onZoomImage(playerDiscountProgram.document)" 
            class="document-image" [src]="playerDiscountProgram.document" />
          </ion-thumbnail>
          
          <!-- <ion-thumbnail *ngIf="temporaryImageURL">
            <img (click)="onZoomImage(temporaryImageURL)" 
        class="document-image" [src]="temporaryImageURL" />
      </ion-thumbnail> -->
      
</ion-list>
<ion-list *ngIf="type==='playerDiscount' && mode === 'edit' && optionTypes === 'clubApprovals'">

    <ng-container *ngIf="clubList && clubList.totalItems === 0 || !clubList">
        <ion-item>
            <button ion-button clear  color="danger">
                There are no clubs that have subscribed to this card yet.
            </button>
        </ion-item>
    </ng-container>
    
    <ng-container *ngIf="clubList && clubList.totalItems > 0">
        <ion-item>
            <button ion-button clear>
                There are&nbsp;<strong>{{clubList.totalItems}}</strong>&nbsp;club(s) that have subscribed to this card.
            </button>
        </ion-item>
    </ng-container>
    <ion-list-header>
        <button ion-button outline block (click)="getListApplications()">
            Club(s) Applied <i class="fa fa-fw fa-sync"></i>
        </button>
    </ion-list-header>
    <ng-container  *ngIf="pendingPDP && pendingPDP.length > 0" >
        <ion-item *ngFor="let club of pendingPDP">
            <ion-avatar item-start class="avatar-left custom-avatar">
                <img [src]="getClubImage(club.club)" />
            </ion-avatar>
            <ion-label item-start>{{club.club.name}}</ion-label>
            <button *ngIf="club.approved" item-end ion-button outline>
                <span>Approved</span>
            </button>
            <button *ngIf="!club.approved" item-end ion-button outline color="danger">
                <span>Pending</span>
            </button>
            <button (click)="onRemoveClubApplication(club)" item-end ion-button outline color="danger">
                <span><i class="fas fa-fw fa-times"></i></span>
            </button>
            
            
        </ion-item>
    </ng-container>
</ion-list>
<ion-list *ngIf="type==='playerDiscount' && mode === 'approval'">
    <!-- <button *ngIf="mode === 'approval'" ion-button block outline (click)="onPrivilegeApplyClub(playerDiscountProgram)">
        Get Club(s) Approval to use this card
    </button> -->
    <ng-container *ngIf="clubList && clubList.totalItems === 0 || !clubList">
        <ion-item>
            <button ion-button clear  color="danger">
                There are no clubs that have subscribed to this card yet.
            </button>
        </ion-item>
    </ng-container>
    
    <ng-container *ngIf="clubList && clubList.totalItems > 0">
        <ion-item>
            <button ion-button clear>
                There are&nbsp;<strong>{{clubList.totalItems}}</strong>&nbsp;club(s) that have subscribed to this card.
            </button>
        </ion-item>
    </ng-container>
    <ion-list-header>
        <button ion-button block (click)="getListApplications()">
            Club(s) Applied <i class="fa fa-fw fa-sync"></i>
        </button>
    </ion-list-header>
    <ng-container  *ngIf="pendingPDP && pendingPDP.length > 0" >
        <ion-item *ngFor="let club of pendingPDP">
            <ion-avatar item-start class="avatar-left custom-avatar"> 
                <img [src]="getClubImage(club.club)" />
            </ion-avatar>
            <ion-label item-start>{{club.club.name}}</ion-label>
            <button *ngIf="club.approved" item-end ion-button outline>
                <span>Approved</span>
            </button>
            <button *ngIf="!club.approved" item-end ion-button outline color="danger">
                <span>Pending</span>
            </button>
            <button (click)="onRemoveClubApplication(club)" item-end ion-button outline color="danger">
                <span><i class="fas fa-fw fa-times"></i></span>
            </button>
            
            
        </ion-item>
    </ng-container>
</ion-list>

<ion-list *ngIf="type==='playerVoucher'">

</ion-list>
    
</ion-content >
<ion-footer style="background:white">
    <!-- <button full outline ion-button color="primary" style="font-weight: bold"> -->
        <!-- Current Slot Details :  -->
        <!-- {{getCurrentSlotDetails('courseName')}}
        {{getCurrentSlotDetails('time')}} -->
    <!-- </button> -->
    
    <button *ngIf="mode === 'approval' || (mode==='edit' && optionTypes === 'clubApprovals')" 
    ion-button full (click)="onPrivilegeApplyClub(playerDiscountProgram)">
        Get Club(s) Approval
    </button>
    <!-- <button ion-button full (click)="onPrivilegeApplyClub(playerDiscountProgram)">
        Get Club(s) Approval to use this card
    </button> -->
    <button [disabled]="!isCordova()" *ngIf="type === 'playerType' && mode === 'new'" (click)="onAddPlayerType()"  ion-button full>
        <span *ngIf="mode === 'new'">Add</span>
    </button>
    <button *ngIf="type === 'playerDiscount' && mode === 'new'" (click)="onAddDiscountCard()"  ion-button full>
        <span *ngIf="mode === 'new'">Add</span>
    </button>

    <button *ngIf="mode === 'edit' && optionTypes === 'details'" (click)="onUpdateDiscountCard()"  ion-button full>
        <span *ngIf="mode === 'edit'">Update</span>
    </button>
    <button (click)="close()"  ion-button full color='danger'>Close</button>
</ion-footer>
